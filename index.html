<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HRMS â€“ Demo</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  
<header>
  <h1>HRMS Admin</h1>
  <a href="#" id="logoutBtn" style="display:none;">Logout</a>
</header>

<div class="image-container">
  <img src="doctor_cartoon.webp" alt="Doctor Cartoon" width="200">
</div>

<!-- Signup Section -->
<button id="toggleSignupBtn">Signup</button>
<section id="signupSection" style="display:none;">
  <h2>Signup</h2>
  <input type="text" id="firstName" placeholder="First Name">
  <input type="text" id="middleName" placeholder="Middle Name">
  <input type="text" id="lastName" placeholder="Last Name">
  <input type="email" id="signupEmail" placeholder="Email">
  <input type="password" id="signupPassword" placeholder="Password">
  <input type="date" id="dob" placeholder="Date of Birth">
  <button id="signupBtn">Signup</button>
</section>

<!-- Login Section -->
<section id="loginSection">
  <h2>HRMS Login</h2>
  <button id="toggleLoginBtn">Login</button>
  <div id="loginForm" style="display:none;">
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn">Submit</button>
  </div>
</section>

<!-- Live Availability Section -->
<section id="liveSection" style="display:none;">
  <h2>Live Availability</h2>
  <button id="toggleLiveBtn">Show Availability Form</button>
  <div id="liveForm" style="display:none;">
    <div class="grid">
      <!-- Doctor Type -->
      <select id="doctorType">
        <option value="">Select Doctor Type</option>
        <option value="general">General Physician</option>
        <option value="cardiologist">Cardiologist</option>
        <option value="neurologist">Neurologist</option>
        <!-- Add remaining types -->
      </select>
      <p id="selectedDoctor" style="font-weight:bold;"></p>

      <!-- Resource -->
      <select id="resourceSelect">
        <option value="">Select Resource</option>
        <option>BED</option>
        <option>ICU</option>
        <option>OXYGEN</option>
        <option>VENTILATOR</option>
      </select>

      <!-- State & District -->
      <select id="stateSelect">
        <option value="">Select State</option>
        <option value="MP">Madhya Pradesh</option>
        <option value="MH">Maharashtra</option>
        <!-- Add remaining states -->
      </select>
      <select id="districtSelect">
        <option value="">Select District</option>
      </select>

      <input type="number" id="minAvailability" placeholder="Min Availability" value="1">
      <button id="searchBtn">Search</button>
    </div>

    <!-- Example Results -->
    <div class="result-card">
      <div class="hospital-name">City Hospital â€“ Main Branch</div>
      <div class="available">Available: 5</div>
    </div>
    <div class="result-card">
      <div class="hospital-name">Green Care â€“ Branch 2</div>
      <div class="available">Available: 3</div>
    </div>
  </div>
</section>

<!-- Emergency Contacts -->
<section id="emergencySection">
  <h2>Emergency Contacts</h2>
  <div class="contact-card"><span>Ambulance:</span> <a href="tel:102">102</a></div>
  <div class="contact-card"><span>Police:</span> <a href="tel:100">100</a></div>
  <div class="contact-card"><span>Fire:</span> <a href="tel:101">101</a></div>
</section>

<footer>
  Connected to: <code>http://localhost:4000</code>
</footer>

<script>
  // ---------- Toggle Sections ----------
  const toggleSignupBtn = document.getElementById("toggleSignupBtn");
  const signupSection = document.getElementById("signupSection");
  toggleSignupBtn.addEventListener("click", () => {
    signupSection.style.display = signupSection.style.display === "none" ? "block" : "none";
    toggleSignupBtn.textContent = signupSection.style.display === "block" ? "Hide Signup Form" : "Signup";
  });

  const toggleLoginBtn = document.getElementById("toggleLoginBtn");
  const loginForm = document.getElementById("loginForm");
  toggleLoginBtn.addEventListener("click", () => {
    loginForm.style.display = loginForm.style.display === "none" ? "block" : "none";
    toggleLoginBtn.textContent = loginForm.style.display === "block" ? "Hide Login" : "Login";
  });

  const toggleLiveBtn = document.getElementById("toggleLiveBtn");
  const liveForm = document.getElementById("liveForm");
  toggleLiveBtn.addEventListener("click", () => {
    liveForm.style.display = liveForm.style.display === "none" ? "block" : "none";
  });

  // ---------- Signup ----------
  document.getElementById("signupBtn").addEventListener("click", async () => {
    const payload = {
      firstName: document.getElementById("firstName").value,
      middleName: document.getElementById("middleName").value,
      lastName: document.getElementById("lastName").value,
      email: document.getElementById("signupEmail").value,
      password: document.getElementById("signupPassword").value,
      dob: document.getElementById("dob").value
    };

    try {
      const res = await fetch("http://localhost:4000/signup", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });
      const data = await res.json();
      alert(res.ok ? data.message : data.error);
      if(res.ok){
        signupSection.style.display = "none";
        toggleSignupBtn.textContent = "Signup";
      }
    } catch(e) {
      console.error(e);
      alert("Server error âŒ");
    }
  });

  // ---------- Login & Logout ----------
  const logoutBtn = document.getElementById("logoutBtn");
  const loginSection = document.getElementById("loginSection");
  const liveSection = document.getElementById("liveSection");
  const emergencySection = document.getElementById("emergencySection");

  function setLoggedIn() {
    loginSection.style.display = "none";
    liveSection.style.display = "block";
    emergencySection.style.display = "none";
    logoutBtn.style.display = "inline-block";
    toggleSignupBtn.style.display = "none";
    signupSection.style.display = "none";
  }

  function setLoggedOut() {
    loginSection.style.display = "block";
    liveSection.style.display = "none";
    emergencySection.style.display = "block";
    logoutBtn.style.display = "none";
    toggleSignupBtn.style.display = "inline-block";
    signupSection.style.display = "none";
    loginForm.style.display = "none";
    toggleLoginBtn.textContent = "Login";
    document.getElementById("email").value = "";
    document.getElementById("password").value = "";
  }

  window.onload = () => {
    localStorage.getItem("loggedIn") === "true" ? setLoggedIn() : setLoggedOut();
  };

  document.getElementById("loginBtn").addEventListener("click", () => {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;

    if(email === "admin@hrms.local" && pass === "Admin#1234"){
      alert("Login Successful âœ…");
      localStorage.setItem("loggedIn","true");
      setLoggedIn();
    } else alert("Invalid Email or Password âŒ");
  });

  logoutBtn.addEventListener("click", e => {
    e.preventDefault();
    alert("Logged Out ðŸšª");
    localStorage.removeItem("loggedIn");
    setLoggedOut();
  });

  // ---------- Doctor Selection ----------
  const doctorSelect = document.getElementById("doctorType");
  const selectedDoctorText = document.getElementById("selectedDoctor");
  doctorSelect.addEventListener("change", () => {
    selectedDoctorText.textContent = doctorSelect.value ? "Selected Doctor: " + doctorSelect.options[doctorSelect.selectedIndex].text : "";
  });

  // ---------- State â†’ District ----------
  const districts = {
    "MP": ["Bhopal", "Indore", "Gwalior", "Jabalpur"],
    "MH": ["Mumbai", "Pune", "Nagpur", "Nashik"]
  };
  document.getElementById("stateSelect").addEventListener("change", function(){
    const districtSelect = document.getElementById("districtSelect");
    districtSelect.innerHTML = "<option value=''>Select District</option>";
    if(districts[this.value]){
      districts[this.value].forEach(d => {
        let opt = document.createElement("option");
        opt.value = d;
        opt.textContent = d;
        districtSelect.appendChild(opt);
      });
    }
  });
</script>
</body>
</html>
